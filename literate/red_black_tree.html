<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>red_black_tree.py</title>
  <link rel="stylesheet" href="http://marcoy.github.com/css/pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>red_black_tree.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h1>Red-Black Tree</h1>
<ol>
<li>Every node is either red or black.</li>
<li>The root is black.</li>
<li>Every leaf (nil or self.nil or RBLeaf) is black.</li>
<li>If a node is red, then both of its children are black.</li>
<li>For each node, all simple paths from the node to descendant leaves
   contain the same number of black nodes.</li>
</ol>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">inspect</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>A red-black tree node. The node has references to both its children, its
parent, and its colour.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">RBNode</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span>    <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">red</span>    <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span>   <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span>  <span class="o">=</span> <span class="bp">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;key: </span><span class="si">%s</span><span class="s">, colour: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
                                       <span class="s">&quot;red&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">red</span> <span class="k">else</span> <span class="s">&quot;black&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;key: </span><span class="si">%s</span><span class="s">, colour: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
                                       <span class="s">&quot;red&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">red</span> <span class="k">else</span> <span class="s">&quot;black&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>A sentinel value that represents the leaf node. This is equivalent to <em>nil</em>,
and as stated in property 3, it is black.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">RBLeaf</span><span class="p">(</span><span class="n">RBNode</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RBLeaf</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>The Red-Black tree supports three main operations:</p>
<ol>
<li>Insert</li>
<li>Delete</li>
<li>Search</li>
</ol>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">RedBlackTree</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nil</span>  <span class="o">=</span> <span class="n">RBLeaf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <h2>Insert</h2>
<p>After insertion, only properties 2, and 4 may be violated. 1 and 3 are
trivial to explain. Property 5 won't be violated because <code>insert()</code> colours
the inserted node red.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">RBNode</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>BST insert</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">while</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
            <span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">key</span> <span class="o">&lt;</span> <span class="n">x</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">left</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">right</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Fix up the parent's reference to the newly inserted node</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">z</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">z</span>
        <span class="k">elif</span> <span class="n">z</span><span class="o">.</span><span class="n">key</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
            <span class="n">y</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">z</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">z</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Colour the new node red</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">z</span><span class="o">.</span><span class="n">left</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span>
        <span class="n">z</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span>
        <span class="n">z</span><span class="o">.</span><span class="n">red</span>   <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">insertFixup</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <h2>Search</h2>
<p>Search for <code>key</code> in the tree rooted at <code>x</code></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">None</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
        <span class="k">while</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="n">x</span><span class="o">.</span><span class="n">key</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">left</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">right</span>

        <span class="k">return</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span> <span class="k">else</span> <span class="bp">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <h2>Delete</h2>
<p>Typical BST delete with some extra book keeping.</p>
<ul>
<li>If z has no child, then the first if will take care of such case. It
  will also take care the case where z only has right child---replace z
  with its right child.</li>
<li>If z only has a left child, replace z with its left child.</li>
<li>If z has both children, find z's successor y. Then splice y out of its
  current position in the tree, and replace z with y.<ul>
<li>If y is z's right child, then replace z with y and leave y's right
  child alone.</li>
<li>Otherwise, y is in z's right subtree. Replace y with its right
  child.  Then replace z with y.</li>
</ul>
</li>
</ul>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
        <span class="n">yOriginalColour</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">red</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Replace z with its right and only child.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">left</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">right</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">right</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Replace z with its left and only child.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">elif</span> <span class="n">z</span><span class="o">.</span><span class="n">right</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">left</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Find z's successor, y. It's in the right subtree.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
            <span class="n">yOriginalColour</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">red</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>If y is the right child of z, then we replace z with y, leaving
y's right child alone.</p>
<pre><code>  z
 / \
l   y
   / \
 nil  x
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">right</span>
            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="n">z</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">y</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>Otherwise, y must be in z's right subtree.
Replace y with its right child, x. Then, y gets its right child
from z.</p>
<pre><code>    z
   / \
  l   r
     / \
    /   \
   y    ..
  / \
nil  x
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">right</span>
                <span class="n">y</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">y</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>Replace z with its successor y.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">transplant</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>Fix up the left child and colour.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">y</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">left</span>
            <span class="n">y</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">y</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">red</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>if y's original colour was black, it could violate the Red Black tree
properties.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">if</span> <span class="ow">not</span> <span class="n">yOriginalColour</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteFixup</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>The while loop (<code>while z.parent.red</code>) maintains three loop invariants:</p>
<ol>
<li>Node z is red.</li>
<li>If z's parent is the root, then z's parent is black.</li>
<li>The tree only violates properties 2, and 4. If property 2 is violated,
   it is because z is root and it is red. If property 4 is violated, it
   is because z and its parent are both red.</li>
</ol>
<p>There are six cases to consider, but three of them are symmertric to the
other three.</p>
<ol>
<li>z's uncle y is red.</li>
<li>z's uncle y is black and z is a right child.</li>
<li>z's uncle y is black and z is a left child.</li>
</ol>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">insertFixup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="k">while</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p><code>y</code> is the Uncle</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="n">y</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <h3>Case 1: z's uncle y is red</h3>
<p>Colour both z's parent and z's uncle black. Then colour
z's grandparent red, thereby maintaining property 5.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">y</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <h3>Case 2 and 3</h3>
<p>z's parent is red, but z's uncle is black and z is the right
child, transform into case 3 with a left rotation. In case 3,
colour z's parent black, and z's grandparent red. Then right
rotate pivoted at z's grandparent.
G is the grandparent; P is the parent; U is the unlce (y); a
is some subtree (present for clarity).</p>
<pre><code>  G             G            P
 / \           / \          / \
P   U  ===&gt;   P   U  ===&gt;  z   G
 \           / \              / \
  z         z   a            a   U
case 2       case 3
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <h4>Case 2: z's uncle y is black and z is a right child</h4>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                    <span class="k">if</span> <span class="n">z</span> <span class="o">==</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span><span class="p">:</span>
                        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">leftRotate</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <h4>Case 3: z's uncle y is black and z is a left child</h4>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rightRotate</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>Symmertric to the other branch with left and right reversed.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="n">y</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span>
                <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">y</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">z</span> <span class="o">==</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
                        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">parent</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rightRotate</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">leftRotate</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>Resolves the possible violation of properties 1, 2 , and 4. From
<code>delete()</code>, x is the right child of y; y is either a child of z, the node
being deleted, or the successor of z. After y is removed or moved, y's
blackness is <em>pushed</em> to x. Hence, x's colour is either red-and-black or
doubly black. In other words, it contributes either 2 or 1 respectively,
to the count of black nodes on simple paths containing x. The colour
attribute of x will still be either <strong>RED</strong> (if x is red-and-black) or
<strong>BLACK</strong> (if x is doubly black).</p>
<p>Reference: CLRS Section 13.4</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">deleteFixup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">while</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">red</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>x is the left child</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p><code>w</code> refers to the sibling</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <h3>Case 1: If x's sibling is red, convert to case 2, 3, and 4.</h3>
<p>N = <code>x</code> and S = <code>w</code></p>
<p><img alt="Case 1" src="http://upload.wikimedia.org/wikipedia/commons/3/39/Red-black_tree_delete_case_2.png" /></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">leftRotate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <h3>Case 2: x's sibling, w, is black, and both of w's children are black</h3>
<p>Simply colouring w red will make all the paths that pass
through w has one less black node, but since the paths that
pass through x already have one less black node due to the
removal of x's old parent (in <code>delete()</code>), colouring w to red
evens the black count out. However, paths that go through
x.parent has one fewer black node than the paths that don't
pass through x.parent, so we restart the rebalancing starting
at x.parent.</p>
<p>N = <code>x</code> and S = <code>w</code></p>
<p><img alt="Case 2" src="http://upload.wikimedia.org/wikipedia/commons/c/c7/Red-black_tree_delete_case_3.png" /></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">red</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">w</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <h3>Case 3: x's sibling w is black, w's left child is red and right child is black</h3>
<p>Transform to case 4 by swapping colour of w and w's left
child, rotating right at w and updating the sibling
reference.</p>
<p>S = <code>w</code></p>
<p><img alt="Case 3" src="http://upload.wikimedia.org/wikipedia/commons/3/30/Red-black_tree_delete_case_5.png" /></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rightRotate</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                        <span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <h3>Case 4: x's sibling w is black, w's left child is black and right child is red</h3>
<p>Before the fix up all paths that go through x has one less
black node, so we add one more black node black by left
rotating at x.parent and colour x.parent black. Now, x's
sibling has become the grandparent of x, and we colour its
right child black from red to balance out the black node
count.</p>
<p>N = <code>x</code> and S = <code>w</code></p>
<p><img alt="Case 4" src="http://upload.wikimedia.org/wikipedia/commons/3/31/Red-black_tree_delete_case_6.png" /></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                    <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">leftRotate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span>

                <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rightRotate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">red</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">w</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">red</span><span class="p">:</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">True</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">leftRotate</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
                        <span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span>

                    <span class="n">w</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rightRotate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
        <span class="n">x</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="bp">False</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <pre><code>  |                  |
  x                  y
 / \    =======&gt;    / \
A   y              x   C
   / \            / \
  B   C          A   B
</code></pre>
<p>x and y are nodes. A, B, and C are subtrees.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">leftRotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">right</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>Turn y's left subtree into x's right subtree</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">x</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">left</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">left</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="n">y</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">x</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>Link x's parent to y, and fix up parent's link</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">y</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">y</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>Put x on y's left</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">y</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">x</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">y</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <pre><code>    |                  |
    y                  x
   / \   ========&gt;    / \
  x   C              A   y
 / \                    / \
A   B                  B   C
</code></pre>
<p>x and y are nodes. A, B, and C are subtrees.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">rightRotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">left</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Turn x's right subtree into y's left subtree</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">y</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">right</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">right</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">y</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>Link y's parent to x, and fix up parent's link</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">x</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">parent</span>
        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="n">y</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
            <span class="n">y</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">x</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>Put y on x's right</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">x</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">y</span>
        <span class="n">y</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">x</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <p>Replace subtree <code>u</code> with subtree <code>v</code>.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">transplant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="n">u</span> <span class="o">==</span> <span class="n">u</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span><span class="p">:</span>
            <span class="n">u</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">u</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">v</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">parent</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>Returns the minimum of a subtree rooted at x.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">minimum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
        <span class="k">while</span> <span class="n">x</span><span class="o">.</span><span class="n">left</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">left</span>
        <span class="k">return</span> <span class="n">x</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">isRightChild</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">right</span> <span class="o">==</span> <span class="bp">self</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">isLeftChild</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">nil</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">left</span> <span class="o">==</span> <span class="bp">self</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Red Black Tree&quot;</span><span class="p">)</span>
    <span class="n">rbtree</span> <span class="o">=</span> <span class="n">RedBlackTree</span><span class="p">()</span>
    <span class="n">rbtree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">rbtree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">rbtree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">rbtree</span><span class="o">.</span><span class="n">root</span>
    <span class="k">print</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>

    <span class="n">rbtree</span> <span class="o">=</span> <span class="n">RedBlackTree</span><span class="p">()</span>
    <span class="n">rbtree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">rbtree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">rbtree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">rbtree</span><span class="o">.</span><span class="n">root</span>
    <span class="k">print</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
